my_IS <- read_csv("raw_data/standards_info.csv")
pos_norm_key <- read_xlsx("raw_data/normalization_info.xlsx", sheet = 1)
neg_norm_key <- read_xlsx("raw_data/normalization_info.xlsx", sheet = 2)
pos_norm <- merge(pos_norm_key, my_IS, by = "IS_abbreviation", all = T)
neg_norm <- merge(neg_norm_key, my_IS, by = "IS_abbreviation", all = T)
rm(pos_norm_key, neg_norm_key)
pos_IS <- pos_data |>
select(Sample, any_of(IS_name))
IS_name <- my_IS$Standard
pos_norm_key <- read_xlsx("raw_data/normalization_info.xlsx", sheet = 1)
neg_norm_key <- read_xlsx("raw_data/normalization_info.xlsx", sheet = 2)
pos_norm <- merge(pos_norm_key, my_IS, by = "IS_abbreviation", all = T)
neg_norm <- merge(neg_norm_key, my_IS, by = "IS_abbreviation", all = T)
rm(pos_norm_key, neg_norm_key)
pos_IS <- pos_data |>
select(Sample, any_of(IS_name))
neg_IS <- neg_data |>
select(Sample, any_of(IS_name))
pos_IS <- pos_IS |>
pivot_longer(cols = -c('Sample'),
names_to = 'Standard',
values_to = 'Intensity')
neg_IS <- neg_IS |>
pivot_longer(cols = -c('Sample'),
names_to = 'Standard',
values_to = 'Intensity')
pos_IS <- merge(pos_IS, my_IS, by = "Standard")
neg_IS <- merge(neg_IS, my_IS, by = "Standard")
pos_IS <- pos_IS |>
mutate(pmol_norm = pmol_inj_neg/Intensity)
neg_IS <- neg_IS |>
mutate(pmol_norm = pmol_inj_neg/Intensity)
pos_IS <- pos_IS |> select(Sample, Standard, pmol_norm) |>
pivot_wider(names_from = Standard,
values_from = pmol_norm)
neg_IS <- neg_IS |> select(Sample, Standard, pmol_norm) |>
pivot_wider(names_from = Standard,
values_from = pmol_norm)
pos_data |>
select(-any_of(IS_name))
rm(my_IS)
IS_name <- my_IS$Standard
my_IS <- read_csv("raw_data/standards_info.csv")
IS_name <- my_IS$Standard
pos_data <- pos_data |>
select(-any_of(IS_name))
View(pos_data)
neg_data <- neg_data |>
select(-any_of(IS_name))
pos_data <- merge(pos_data, pos_IS, by = "Sample")
View(pos_data)
neg_data <- merge(neg_data, neg_IS, by = "Sample")
pos_data[,a]
pos_data[,'a']
a <- names(pos_IS)[6]
pos_data[,a]
pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] <-   pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] * pos_data[,a]
pos_data <- pos_data |>
select(-any_of(IS_name))
neg_data <- neg_data |>
select(-any_of(IS_name))
pos_data <- merge(pos_data, pos_IS, by = "Sample")
neg_data <- merge(neg_data, neg_IS, by = "Sample")
a <- names(pos_IS)[6]
temp <- pos_norm |> filter(Standard.x %in% a)
toMatch <- temp$Regex
pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] <-   pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] * pos_data[,a]
View(pos_data)
View(pos_IS)
names(pos_IS)[-1]
for (i in names(pos_IS)[-1]) {
temp <- pos_norm |> filter(Standard.x %in% a)
toMatch <- temp$Regex
pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] <-   pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] * pos_data[,a]
}
View(pos_data)
for (i in names(pos_IS)[-1]) {
temp <- pos_norm |> filter(Standard.x %in% a)
toMatch <- temp$Regex
pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] <-   pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] * pos_data[,i]
}
View(pos_data)
for (i in names(pos_IS)[-1]) {
temp <- pos_norm |> filter(Standard.x %in% i)
toMatch <- temp$Regex
pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] <-   pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] * pos_data[,i]
}
View(pos_data)
#| echo: false
if(!require(tidyverse)){install.packages("tidyverse")}
if(!require(readxl)){install.packages("readxl")}
if(!require(Cairo)){install.packages("Cairo")}
mypath <- "output/initial_data"
myfiles <- list.files(mypath)
print(myfiles)                                         # Lists data files within folder
filenumber_pos <- 2
filenumber_neg <- 1
loadme <- paste0(mypath, "/", myfiles[filenumber_pos])
pos_data <- read_csv(paste0(loadme))
loadme <- paste0(mypath, "/", myfiles[filenumber_neg])
neg_data <- read_csv(paste0(loadme))
# Make sample names characters
pos_data$Sample <- as.character(pos_data$Sample)
neg_data$Sample <- as.character(neg_data$Sample)
my_IS <- read_csv("raw_data/standards_info.csv")
IS_name <- my_IS$Standard
pos_norm_key <- read_xlsx("raw_data/normalization_info.xlsx", sheet = 1)
neg_norm_key <- read_xlsx("raw_data/normalization_info.xlsx", sheet = 2)
pos_norm <- merge(pos_norm_key, my_IS, by = "IS_abbreviation", all = T)
neg_norm <- merge(neg_norm_key, my_IS, by = "IS_abbreviation", all = T)
rm(pos_norm_key, neg_norm_key)
pos_IS <- pos_data |>
select(Sample, any_of(IS_name))
neg_IS <- neg_data |>
select(Sample, any_of(IS_name))
pos_IS <- pos_IS |>
pivot_longer(cols = -c('Sample'),
names_to = 'Standard',
values_to = 'Intensity')
neg_IS <- neg_IS |>
pivot_longer(cols = -c('Sample'),
names_to = 'Standard',
values_to = 'Intensity')
pos_IS <- merge(pos_IS, my_IS, by = "Standard")
neg_IS <- merge(neg_IS, my_IS, by = "Standard")
pos_IS <- pos_IS |>
mutate(pmol_norm = pmol_inj_neg/Intensity)
neg_IS <- neg_IS |>
mutate(pmol_norm = pmol_inj_neg/Intensity)
pos_IS <- pos_IS |> select(Sample, Standard, pmol_norm) |>
pivot_wider(names_from = Standard,
values_from = pmol_norm)
neg_IS <- neg_IS |> select(Sample, Standard, pmol_norm) |>
pivot_wider(names_from = Standard,
values_from = pmol_norm)
pos_data <- pos_data |>
select(-any_of(IS_name))
neg_data <- neg_data |>
select(-any_of(IS_name))
pos_data <- merge(pos_data, pos_IS, by = "Sample")
neg_data <- merge(neg_data, neg_IS, by = "Sample")
for (i in names(pos_IS)[-1]) {
temp <- pos_norm |> filter(Standard.x %in% i)
toMatch <- temp$Regex
pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] <-   pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] * pos_data[,i]
}
View(pos_data)
for (i in names(neg_IS)[-1]) {
temp <- neg_norm |> filter(Standard.x %in% i)
toMatch <- temp$Regex
neg_data[,grep(paste(toMatch,
collapse= "|"),
names(neg_data),
value = TRUE)
] <-   neg_data[,grep(paste(toMatch,
collapse= "|"),
names(neg_data),
value = TRUE)
] * neg_data[,i]
}
View(neg_data)
pos_data <- pos_data |>
select(-any_of(IS_name))
neg_data <- neg_data |>
select(-any_of(IS_name))
View(pos_data)
View(pos_data)
#| echo: false
if(!require(tidyverse)){install.packages("tidyverse")}
if(!require(readxl)){install.packages("readxl")}
if(!require(Cairo)){install.packages("Cairo")}
mypath <- "output/initial_data"
myfiles <- list.files(mypath)
print(myfiles)                                         # Lists data files within folder
filenumber_pos <- 2
filenumber_neg <- 1
loadme <- paste0(mypath, "/", myfiles[filenumber_pos])
pos_data <- read_csv(paste0(loadme))
loadme <- paste0(mypath, "/", myfiles[filenumber_neg])
neg_data <- read_csv(paste0(loadme))
# Make sample names characters
pos_data$Sample <- as.character(pos_data$Sample)
neg_data$Sample <- as.character(neg_data$Sample)
my_IS <- read_csv("raw_data/standards_info.csv")
IS_name <- my_IS$Standard
pos_IS <- pos_data |>
select(Sample, any_of(IS_name))
pos_IS <- pos_IS |>
mutate_if(is.numeric, log10)
CairoPDF("output/IS_graphs/plasma_pos_IS.pdf")
for(i in names(pos_IS)[-1]){
myvar <- sym(i)
p <- ggplot(data = pos_IS,
aes(x = Sample, y = !!myvar
)
) +
geom_boxplot() +
ylab("log10(Intensity)") +
xlab("Sample") +
scale_y_continuous(limits = c(2, 9)) +
ggtitle(paste0(i))
print(p)
}
dev.off()
neg_IS <- neg_data |>
select(Sample, any_of(IS_name))
neg_IS <- neg_IS |>
mutate_if(is.numeric, log10)
CairoPDF("output/IS_graphs/plasma_neg_IS.pdf")
for(i in names(neg_IS)[-1]){
myvar <- sym(i)
p <- ggplot(data = neg_IS,
aes(x = Sample, y = !!myvar
)
) +
geom_boxplot() +
ylab("log10(Intensity)") +
xlab("Sample") +
scale_y_continuous(limits = c(2, 9)) +
ggtitle(paste0(i))
print(p)
}
dev.off()
rm(i, myvar, p, pos_IS, neg_IS)
pos_norm_key <- read_xlsx("raw_data/normalization_info.xlsx", sheet = 1)
neg_norm_key <- read_xlsx("raw_data/normalization_info.xlsx", sheet = 2)
pos_norm <- merge(pos_norm_key, my_IS, by = "IS_abbreviation", all = T)
neg_norm <- merge(neg_norm_key, my_IS, by = "IS_abbreviation", all = T)
rm(pos_norm_key, neg_norm_key)
pos_IS <- pos_data |>
select(Sample, any_of(IS_name))
neg_IS <- neg_data |>
select(Sample, any_of(IS_name))
pos_IS <- pos_IS |>
pivot_longer(cols = -c('Sample'),
names_to = 'Standard',
values_to = 'Intensity')
neg_IS <- neg_IS |>
pivot_longer(cols = -c('Sample'),
names_to = 'Standard',
values_to = 'Intensity')
pos_IS <- merge(pos_IS, my_IS, by = "Standard")
neg_IS <- merge(neg_IS, my_IS, by = "Standard")
pos_IS <- pos_IS |>
mutate(pmol_norm = pmol_inj_neg/Intensity)
neg_IS <- neg_IS |>
mutate(pmol_norm = pmol_inj_neg/Intensity)
pos_IS <- pos_IS |> select(Sample, Standard, pmol_norm) |>
pivot_wider(names_from = Standard,
values_from = pmol_norm)
neg_IS <- neg_IS |> select(Sample, Standard, pmol_norm) |>
pivot_wider(names_from = Standard,
values_from = pmol_norm)
pos_data <- pos_data |>
select(-any_of(IS_name))
neg_data <- neg_data |>
select(-any_of(IS_name))
pos_data <- merge(pos_data, pos_IS, by = "Sample")
neg_data <- merge(neg_data, neg_IS, by = "Sample")
for (i in names(pos_IS)[-1]) {
temp <- pos_norm |> filter(Standard.x %in% i)
toMatch <- temp$Regex
pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] <-   pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] * pos_data[,i]
}
for (i in names(neg_IS)[-1]) {
temp <- neg_norm |> filter(Standard.x %in% i)
toMatch <- temp$Regex
neg_data[,grep(paste(toMatch,
collapse= "|"),
names(neg_data),
value = TRUE)
] <-   neg_data[,grep(paste(toMatch,
collapse= "|"),
names(neg_data),
value = TRUE)
] * neg_data[,i]
}
View(my_IS)
View(pos_data)
View(pos_norm)
pos_norm_key <- read_xlsx("raw_data/normalization_info.xlsx", sheet = 1)
View(pos_norm_key)
pos_dat[,grepl("^BMP", names(pos_dat))]
pos_data[,grepl("^BMP", names(pos_data))]
View(pos_data)
test <- pos_data[,grepl("^BMP", names(pos_data))]
test <- pos_data[,grep("^BMP", names(pos_data))]
test <- names(pos_data[,grepl("^BMP", names(pos_data))])
grepl("^BMP", names(pos_data))
pos_data |> select(starts_with("BMP"))
pos_data |> select(starts_with("FA"))
neg_data |> select(starts_with("FA"))
neg_data |> select(starts_with("^PI"))
neg_data |> select(starts_with("^PI"))
neg_data |> select(starts_with("^LPI"))
neg_data |> select(starts_with("^PA"))
neg_data |> select(starts_with("^PS"))
View(neg_data)
pos_data |> select(starts_with("BMP"))
neg_data |> select(starts_with("^FA"))
pos_norm <- merge(pos_norm_key, my_IS, by = "IS_abbreviation", all = T)
neg_norm <- merge(neg_norm_key, my_IS, by = "IS_abbreviation", all = T)
View(pos_data)
View(pos_data)
View(pos_norm)
View(pos_data)
pos_data <- pos_data[,first:ncol(pos_data)]/pos_data[,tonorm]
pos_data[,tonorm]
first = 6
# index of weight column
tonorm = 5
pos_data <- pos_data[,first:ncol(pos_data)]/pos_data[,tonorm]
neg_data <- neg_data[,first:ncol(neg_data)]/neg_data[,tonorm]
View(pos_data)
#| echo: false
if(!require(tidyverse)){install.packages("tidyverse")}
if(!require(readxl)){install.packages("readxl")}
if(!require(Cairo)){install.packages("Cairo")}
mypath <- "output/initial_data"
myfiles <- list.files(mypath)
print(myfiles)                                         # Lists data files within folder
filenumber_pos <- 2
filenumber_neg <- 1
loadme <- paste0(mypath, "/", myfiles[filenumber_pos])
pos_data <- read_csv(paste0(loadme))
loadme <- paste0(mypath, "/", myfiles[filenumber_neg])
neg_data <- read_csv(paste0(loadme))
# Make sample names characters
pos_data$Sample <- as.character(pos_data$Sample)
neg_data$Sample <- as.character(neg_data$Sample)
my_IS <- read_csv("raw_data/standards_info.csv")
IS_name <- my_IS$Standard
pos_IS <- pos_data |>
select(Sample, any_of(IS_name))
pos_IS <- pos_IS |>
mutate_if(is.numeric, log10)
CairoPDF("output/IS_graphs/plasma_pos_IS.pdf")
for(i in names(pos_IS)[-1]){
myvar <- sym(i)
p <- ggplot(data = pos_IS,
aes(x = Sample, y = !!myvar
)
) +
geom_boxplot() +
ylab("log10(Intensity)") +
xlab("Sample") +
scale_y_continuous(limits = c(2, 9)) +
ggtitle(paste0(i))
print(p)
}
dev.off()
neg_IS <- neg_data |>
select(Sample, any_of(IS_name))
neg_IS <- neg_IS |>
mutate_if(is.numeric, log10)
CairoPDF("output/IS_graphs/plasma_neg_IS.pdf")
for(i in names(neg_IS)[-1]){
myvar <- sym(i)
p <- ggplot(data = neg_IS,
aes(x = Sample, y = !!myvar
)
) +
geom_boxplot() +
ylab("log10(Intensity)") +
xlab("Sample") +
scale_y_continuous(limits = c(2, 9)) +
ggtitle(paste0(i))
print(p)
}
dev.off()
rm(i, myvar, p, pos_IS, neg_IS)
pos_norm_key <- read_xlsx("raw_data/normalization_info.xlsx", sheet = 1)
neg_norm_key <- read_xlsx("raw_data/normalization_info.xlsx", sheet = 2)
pos_data |> select(starts_with("^BMP"))
neg_data |> select(starts_with("^FA"))
pos_norm <- merge(pos_norm_key, my_IS, by = "IS_abbreviation", all = T)
neg_norm <- merge(neg_norm_key, my_IS, by = "IS_abbreviation", all = T)
rm(pos_norm_key, neg_norm_key)
pos_IS <- pos_data |>
select(Sample, any_of(IS_name))
neg_IS <- neg_data |>
select(Sample, any_of(IS_name))
pos_IS <- pos_IS |>
pivot_longer(cols = -c('Sample'),
names_to = 'Standard',
values_to = 'Intensity')
neg_IS <- neg_IS |>
pivot_longer(cols = -c('Sample'),
names_to = 'Standard',
values_to = 'Intensity')
pos_IS <- merge(pos_IS, my_IS, by = "Standard")
neg_IS <- merge(neg_IS, my_IS, by = "Standard")
pos_IS <- pos_IS |>
mutate(pmol_norm = pmol_inj_neg/Intensity)
neg_IS <- neg_IS |>
mutate(pmol_norm = pmol_inj_neg/Intensity)
pos_IS <- pos_IS |> select(Sample, Standard, pmol_norm) |>
pivot_wider(names_from = Standard,
values_from = pmol_norm)
neg_IS <- neg_IS |> select(Sample, Standard, pmol_norm) |>
pivot_wider(names_from = Standard,
values_from = pmol_norm)
pos_data <- pos_data |>
select(-any_of(IS_name))
neg_data <- neg_data |>
select(-any_of(IS_name))
pos_data <- merge(pos_data, pos_IS, by = "Sample")
neg_data <- merge(neg_data, neg_IS, by = "Sample")
for (i in names(pos_IS)[-1]) {
temp <- pos_norm |> filter(Standard.x %in% i)
toMatch <- temp$Regex
pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] <-   pos_data[,grep(paste(toMatch,
collapse= "|"),
names(pos_data),
value = TRUE)
] * pos_data[,i]
}
for (i in names(neg_IS)[-1]) {
temp <- neg_norm |> filter(Standard.x %in% i)
toMatch <- temp$Regex
neg_data[,grep(paste(toMatch,
collapse= "|"),
names(neg_data),
value = TRUE)
] <-   neg_data[,grep(paste(toMatch,
collapse= "|"),
names(neg_data),
value = TRUE)
] * neg_data[,i]
}
pos_data <- pos_data |>
select(-any_of(IS_name))
neg_data <- neg_data |>
select(-any_of(IS_name))
# index of first lipid column
first = 6
# index of weight column
tonorm = 5
pos_data[,first:ncol(pos_data)] <- pos_data[,first:ncol(pos_data)]/pos_data[,tonorm]
neg_data[,first:ncol(neg_data)] <- neg_data[,first:ncol(neg_data)]/neg_data[,tonorm]
View(pos_data)
View(pos_data)
View(pos_data)
write_csv(pos_data, file = "output/final_curated/plasma_pos_uM.csv")
write_csv(neg_data, file = "output/final_curated/plasma_neg_uM.csv")
rm(list = ls())
sessionInfo()
#| echo: false
if(!require(tidyverse)){install.packages("tidyverse")}
if(!require(dplyr)){install.packages("dplyr")}
if(!require(Cairo)){install.packages("Cairo")}
sessionInfo()
